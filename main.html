<html>
  <head></head>
  <body onload="draw();">
    <canvas id="tutorial" width="400" height="600" style='border: 1px solid black;'></canvas>
  </body>
  <script type="text/javascript">
    var canvas = document.getElementById("tutorial")
    var ctx = canvas.getContext("2d")
    var CANVAS_WIDTH = 400 
    var CANVAS_HEIGHT = 600 
    var BIRD_WIDTH = 40
    var BIRD_HEIGHT = 40
    var x = CANVAS_WIDTH / 2 - BIRD_WIDTH / 2 
    var y = CANVAS_HEIGHT / 2 - BIRD_HEIGHT / 2
    var angle = 0  // bird rotate angle 
    var img = new Image()
    img.onload = function () {
      ctx.drawImage(img, x, y, BIRD_WIDTH, BIRD_HEIGHT)
    }
    img.src = 'bird.jpeg'

    function draw() {
      window.addEventListener('keydown', pressKeyHandler, false)
    }
    
    function moveUp() {
      if (y >= 5) {
        y -= 60 
        angle = -20
      }
    }

    function pressKeyHandler(event) {
      switch(event.keyCode) {
        // press Space
        case 32:
          moveUp()
          reDraw()
          break
      }
    }
    
    function reDraw() {
      this.ctx.clearRect(0, 0, canvas.width, canvas.height)
      this.ctx.translate(x + BIRD_WIDTH / 2, y + BIRD_HEIGHT / 2)
      this.ctx.rotate(angle * Math.PI / 180)
      this.ctx.translate(-x - BIRD_WIDTH / 2, -y - BIRD_HEIGHT / 2)
      this.ctx.drawImage(img, x, y, BIRD_WIDTH, BIRD_HEIGHT)
      this.ctx.setTransform(1, 0, 0, 1, 0, 0)
    } 

    var nIntervId = null
    function birdFallBegin() {
      nIntervId = setInterval(birdFall, 100);
    }

    function birdFall() {
      y += 10 
      angle += 3 
      if (angle >= 90) {
        angle = 90
      }  
      if (y >= CANVAS_HEIGHT - BIRD_HEIGHT) {
        clearInterval(nIntervId)
      } else {
        reDraw()
      }
    }

    birdFallBegin()
  </script>  
</html>
